<div class="account-details" *ngIf="account">
  <div class="header">
    <h1>Account Details</h1>
    <div class="actions">
      <button class="btn btn-secondary" routerLink="/accounts">Back to List</button>
      <button class="btn btn-primary" [routerLink]="['/transactions/new']" [queryParams]="{accountId: account.id}">+ New Transaction</button>
    </div>
  </div>

  <div class="account-card">
    <div class="balance-display">
      <h2>Current Balance</h2>
      <div class="balance-amount">{{ account.balance | currencyFormat }}</div>
    </div>

    <div class="account-info">
      <div class="info-item">
        <span class="label">Account Number:</span>
        <span class="value">{{ account.accountNumber }}</span>
      </div>
      <div class="info-item">
        <span class="label">Owner Name:</span>
        <span class="value">{{ account.ownerName }}</span>
      </div>
      <div class="info-item">
        <span class="label">Customer ID:</span>
        <span class="value">
          <a [routerLink]="['/customers', account.customerId]">{{ account.customerId }}</a>
        </span>
      </div>
      <div class="info-item">
        <span class="label">Account ID:</span>
        <span class="value">{{ account.id }}</span>
      </div>
    </div>
  </div>

  <div class="transactions-section">
    <h2>Transaction History ({{ transactions.length }})</h2>

    <!-- Transaction Summary Cards -->
    <div class="summary-cards" *ngIf="transactions.length > 0">
      <div class="summary-card deposit">
        <div class="card-icon">ðŸ’°</div>
        <div class="card-content">
          <div class="card-label">Total Deposits</div>
          <div class="card-value">{{ totalDeposits | currencyFormat }}</div>
          <div class="card-count">{{ depositCount }} transaction{{ depositCount !== 1 ? 's' : '' }}</div>
        </div>
      </div>
      <div class="summary-card withdrawal">
        <div class="card-icon">ðŸ’¸</div>
        <div class="card-content">
          <div class="card-label">Total Withdrawals</div>
          <div class="card-value">{{ totalWithdrawals | currencyFormat }}</div>
          <div class="card-count">{{ withdrawalCount }} transaction{{ withdrawalCount !== 1 ? 's' : '' }}</div>
        </div>
      </div>
      <div class="summary-card transfer">
        <div class="card-icon">ðŸ”„</div>
        <div class="card-content">
          <div class="card-label">Total Transfers</div>
          <div class="card-value">{{ totalTransfers | currencyFormat }}</div>
          <div class="card-count">{{ transferCount }} transaction{{ transferCount !== 1 ? 's' : '' }}</div>
        </div>
      </div>
    </div>

    <!-- Filter Buttons -->
    <div class="filters" *ngIf="transactions.length > 0">
      <button 
        class="filter-btn" 
        [class.active]="selectedType === 'all'"
        (click)="filterByType('all')">
        All ({{ transactions.length }})
      </button>
      <button 
        class="filter-btn deposit" 
        [class.active]="selectedType === 'deposit'"
        (click)="filterByType('deposit')">
        Deposits ({{ depositCount }})
      </button>
      <button 
        class="filter-btn withdrawal" 
        [class.active]="selectedType === 'withdrawal'"
        (click)="filterByType('withdrawal')">
        Withdrawals ({{ withdrawalCount }})
      </button>
      <button 
        class="filter-btn transfer" 
        [class.active]="selectedType === 'transfer'"
        (click)="filterByType('transfer')">
        Transfers ({{ transferCount }})
      </button>
    </div>

    <div class="transactions-table" *ngIf="filteredTransactions.length > 0; else noTransactions">
      <table>
        <thead>
          <tr>
            <th>Date & Time</th>
            <th>Type</th>
            <th>Amount</th>
            <th>Description</th>
            <th>Balance Before</th>
            <th>Balance After</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let transaction of filteredTransactions">
            <td>{{ transaction.timestamp | date:'short' }}</td>
            <td>
              <span 
                class="badge" 
                [class.deposit]="transaction.type === 0"
                [class.withdrawal]="transaction.type === 1"
                [class.transfer]="transaction.type === 2">
                {{ getTransactionTypeLabel(transaction.type) }}
              </span>
            </td>
            <td class="amount">
              <span [class.positive]="transaction.type === 0" [class.negative]="transaction.type === 1">
                {{ transaction.type === 1 ? '-' : '+' }}{{ transaction.amount | currencyFormat }}
              </span>
            </td>
            <td>{{ transaction.description }}</td>
            <td>{{ transaction.balanceBefore | currencyFormat }}</td>
            <td>{{ transaction.balanceAfter | currencyFormat }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <ng-template #noTransactions>
      <div class="no-data">
        <p>No transactions found for this account</p>
        <button class="btn btn-primary" [routerLink]="['/transactions/new']" [queryParams]="{accountId: account.id}">Create First Transaction</button>
      </div>
    </ng-template>
  </div>
</div>

<div class="loading" *ngIf="!account">
  <p>Loading account details...</p>
</div>
